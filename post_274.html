<h2>[6 장] - 커널 오브젝트와 오브젝트 핸들</h2>
<h2>커널 오브젝트</h2>
<ul>
<li>Kernel Object -- Resource</li>
<li>커널에 의해 관리되는 리소스 정보를 담고 있는 데이터 블록.</li>
<li>리소스는 생성 또는 소멸한다.<ul>
<li>파일은 사용자가 관리하기도 하지만 OS 가 관리하는 리소스 측면도 있다.</li>
<li>사용자는 요청만 할 뿐 실제로는 OS 가 제어한다.</li>
</ul>
</li>
<li>실체는 구조체 변수이다!<ul>
<li>프로세스, 스레드 - PCB, 우선순위 등</li>
<li>파일 - 권한, 읽은 위치 등</li>
<li>파이프 등등</li>
</ul>
</li>
<li>OS 에 의해 관리되는 리소스는 커널 오브젝트의 제어를 받지 않는 것은 없다.</li>
<li>리소스를 생성하려면 커널 오브젝트를 먼저 생성한다.</li>
<li>OS 에서 커널은 큰 틀에서 변하지 않았다.</li>
</ul>
<h2>커널 오브젝트와 핸들의 관계</h2>
<ul>
<li>Handle -- Kernel Object -- Resource</li>
<li>커널 오브젝트는 프로그래머가 직접 접근 불가. os 가 직접 관리</li>
<li>커널 오브젝트의 정보를 조작하여 리소스를 변경하고 싶을 때 간접적으로 할 수 있는것이 핸들.</li>
<li>os 가 커널 오브젝트에게 고유한 핸들 정보를 부여한다.</li>
<li>실체는 정수형 숫자이다!</li>
</ul>
<h2>busy waiting</h2>
<ul>
<li>sleep 함수는 프로세스를 block 상태로 만든다.</li>
<li>하지만 빈 루프를 둘리면 running 상태로 공회전한다.</li>
<li>우선순위 확인할 때 sleep 을 쓰면 안된다.</li>
</ul>
<h2>우선 순위 단위</h2>
<ul>
<li>우선 순위는 명령어 단위로 잘린다.</li>
<li>함수는 부분적으로 실행될 수 있다.</li>
<li>명령어가 atomic 하므로.</li>
</ul>
<h2>커널 오브젝트와 핸들의 종속관계</h2>
<ul>
<li>프로세스가 생성되면 os 에 커널 오브젝트와 함께 핸들 테이블이 생성됨.</li>
<li>핸들 값은 커널 오브젝트와 직접 맵핑이 되는것이 아니다.</li>
<li>프로세스 내부에서 사용되는 값이다!</li>
<li>핸들 테이블은 프로세스에 종속되어서 프로세스 내부에서만 유효하다.</li>
<li>Usage Count 는 접근 가능한 프로세스의 수를 나타냄.</li>
<li>부모 프로세스는 자식 프로세스의 핸들값을 가지게 된다.</li>
<li>그래서 UC 는 2 이상인 경우가 많음.</li>
<li>프로세스가 종료되면 커널 오브젝트의 UC 하나를 줄인다.</li>
<li>UC 가 0 이 되었을 때 커널 오브젝트를 소멸시킨다.</li>
</ul>
<h2>커널 오브젝트와 핸들 2</h2>
<ul>
<li>자식 프로세스의 커널 오브젝트는 부모를 포함해 UC 가 2 이상임.</li>
<li>그런데 자식 프로세스가 소멸되었을 때 이 커널 오브젝트를 남겨두어야 하는가?<ul>
<li>자식 프로세스에 의존적일 경우도 있다.</li>
<li>자식 프로세스가 종료되자말자 그 커널 오브젝트를 소멸시키면 부모 프로젝트는 정상 종료 여부를 알기가 힘들다.</li>
</ul>
</li>
<li>프로세스 자신의 핸들을 가지고 있어야 하는가?<ul>
<li>실제로는 핸들 테이블에 핸들은 가지고 있지 않는다.</li>
<li>그저 자기자신의 핸들을 따로 들고있을 뿐이다.</li>
<li>프로세스 자신의 커널 오브젝트는 언제나 참조할 수 있다는 것.</li>
</ul>
</li>
<li>메인 함수의 반환 값은 무슨 의미인가?<ul>
<li>프로세스가 종료될 때 커널 오브젝트에게 반환값이 넘어간다.</li>
</ul>
</li>
<li>ANSI 표준 함수는 결국 시스템 라이브러리 맵핑에 불과</li>
<li>부모 프로세스는 자식 프로세스와 분리할 때 CloseHandle 함수를 호출한다.<ul>
<li>자식 프로세스 커널 오브젝트의 UC 를 하나 줄인다.</li>
<li>자식 프로세스에 접근할 필요가 없을 때</li>
</ul>
</li>
</ul>
